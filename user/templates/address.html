<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>地址</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <script src="{% static 'jquery/jquery-3.5.1.min.js' %}"></script>
    <link rel="stylesheet" href="{% static 'bootstrapt/css/bootstrap.min.css' %}">
    <script src="{% static 'bootstrapt/js/bootstrap.bundle.min.js' %}"></script>
</head>
<body>
    <nav class="navbar navbar-light bg-light border-bottom ">
        <img src="{% static 'img/icons/chevron-left.svg' %}" class="float-left" id="previous_page">
        <div class="h6 float-right text-center " id="user_name">{{request.session.user_name}}的收货信息</div>
        <input id="is_login" value="{{request.session.is_login}}" style="display: none">
        <a class="float-right text-warning pr-3" id="logout">注销</a>
    </nav>
    <!--地址信息表-->
    <div class="list-group ">
        {% for consignee in consignee_dic %}
        <div class="list-group-item list-group-item-action pb-0">
            <div class="container h6 ">
                <div class="row">
                    <div class="col-4 font-weight-bold mb-2" id="consignee_name_{{consignee.id}}">{{consignee.consignee_name}}</div>
                    <div class="col-4 offset-1 font-weight-bold " id="consignee_number_{{consignee.id}}">{{consignee.consignee_number}}</div>
                    <div class="col-12" id="consignee_address_{{consignee.id}}">{{consignee.consignee_address}}</div>
                </div>
            </div>
            <img src="{% static 'img/icons/pencil-square.svg' %}" id="{{consignee.id}}" class="float-right image" >
        </div>

        {% endfor %}
    </div>

    <button type="button" class="btn bg-danger fixed-bottom container text-white" >
        新建收货信息</button>
    <form style="display: none" id="submit">
        {% csrf_token %}
    </form>
</body>
<script>

    $(function () {
        // 点击修改图标进入信息变更界面
        $(".image").click(function () {
        console.log(this)
        var consignee_id_get = $(this).attr("id");
        console.log(consignee_id_get)
        var consignee_name_get = $("#consignee_name_"+consignee_id_get).text()
        var consignee_number_get = $("#consignee_number_"+consignee_id_get).text()
        var consignee_address_get = $("#consignee_address_"+consignee_id_get).text()
        console.log(consignee_name_get,consignee_number_get,consignee_address_get)
        var url = "http://" + window.location.host + "/user/address/"
        console.log(url)

        var form = $('#submit');
        form.attr('action',url);
        form.attr('method','post');

        var consignee_id = $('<input type="text" name="consignee_id">')
        var consignee_name = $('<input type="text" name="consignee_name">')
        var consignee_number = $('<input type="text" name="consignee_number">')
        var consignee_address = $('<input type="text" name="consignee_address">')

        consignee_id.attr('value',consignee_id_get)
        consignee_name.attr('value',consignee_name_get)
        consignee_number.attr('value',consignee_number_get)
        consignee_address.attr('value',consignee_address_get)

        form.append(consignee_id);
        form.append(consignee_name);
        form.append(consignee_number);
        form.append(consignee_address);

        $(document.body).append(form);
        form.submit();
    })
        //点击按钮，新建收货信息
        $(":button").click(function () {
            window.location.href="http://" + window.location.host + "/user/address/address_change/"

        })
        //点击上一页图标，返回上一页
        $("#previous_page").click(function () {
            window.history.back(-1);

        })




    })

</script>
</html>